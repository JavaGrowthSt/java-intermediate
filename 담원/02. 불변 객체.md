### 기본형과 참조형의 공유

- 기본형 : 하나의 값을 여러 변수에서 절대로 공유하지 않는다.
- 참조형 : 하나의 객체를 참조값을 통해 여러 변수에서 공유할 수 있다.

참조형 변수는 참조값을 통해 객체(인스턴스)를 공유할 수 있다.

### 여러 변수가 하나의 객체를 공유하는 것을 막을 방법은 없다.

```java
Address b = new Address("서울") //새로운 객체 참
Address b = a //기존 객체 공유 참조
```

### 불변 객체 - 도입

자바에서 여러 참조형 변수가 하나의 객체(인스턴스)를 참조하는 공유 참조 문제는 피할 수 없다.

객체를 여러 변수에서 공유했기 때문에 발생한 문제. 

객체를 공유한다고 바로 사이드 이펙트가 발생하지는 않는다.

```java
package lang.immutable.address;

public class ImmutableAddress{

		private String value;
		public ImmutableAddress(String value) {this.value = value;}
		public String getValue(){return value;}
		public void setValue(String value){this.value = value;}

}
```

정리

불변이라는 단순한 제약을 사용해서 사이드 이펙트라는 큰 문제를 막을 수 있다.

- 객체의 공유 참조는 막을 수 없다. 그래서 객체의 값을 변경하면 다른 곳에서 참조하는 변수의 값도 함께 변경되는 사이드 이펙트가 발생한다. 사이드 이펙트가 발생하면 안되는 상황이라면 불변 객체를 만들어서 사용하면 된다.
    
    불변 객체는 값을 변경할 수 없기  때문에 사이드 이펙트가 원천 차단된다.
    
- 불변 객체는 값을 변경할 수 없다. 따라서 불변 객체의 값을 변경하고 싶다면 변경하고 싶은 값으로 새로운 불변 객체를 생성해야 한다. 이렇게 하면 기존 변수들이 ㅊ마조하는 값에는 영향을 주지 않는다.

`불변 객체는 기존 값은 변경하지 않고 대신에 계산 결과를 바탕으로 새로운 객체를 만들어서 반환`

### 클래스를 불변으로 설계하는 이유

캐시 안정성

멀티 쓰레드 안정성

엔티티의 값 타입

![image](https://github.com/user-attachments/assets/66414ac4-b96e-4479-9a7a-f8fa88b44bd3)

#### 불변 객체를 설계할 때 기존 값을 변경해야 하는 메서드가 필요할 수 있다. 이때는 기존 객체의 값을 그대로 두고 대신에
#### 변경된 결과를 새로운 객체에 담아서 반환하면 된다. 결과를 보면 기존 값이 그대로 유지되는 것을 확인할 수 있다
